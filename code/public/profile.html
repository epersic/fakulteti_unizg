<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Korisnički profil - Fakulteti UNIZG</title>
  <link rel="stylesheet" href="/styles.css">
  <style>
    .profile-container {
      max-width: 600px;
      margin: 2rem auto;
      padding: 2rem;
      background: #f5f5f5;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .profile-item {
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid #ddd;
    }
    .profile-item:last-child {
      border-bottom: none;
    }
    .profile-label {
      font-weight: bold;
      color: #333;
      display: block;
      margin-bottom: 0.5rem;
    }
    .profile-value {
      color: #666;
      word-break: break-all;
    }
    .profile-picture {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      margin-bottom: 1rem;
    }
    .error-message {
      background: #fee;
      color: #c33;
      padding: 1rem;
      border-radius: 4px;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="nav-container">
      <h1>Fakulteti UNIZG</h1>
      <ul class="nav-links">
        <li><a href="/">Početna</a></li>
        <li><a href="/logout">Odjava</a></li>
      </ul>
    </div>
  </nav>

  <main>
    <div class="profile-container" id="profile-container">
      <h2>Učitavanje profila...</h2>
    </div>
  </main>

  <script>
    async function loadProfile() {
      const container = document.getElementById('profile-container');
      
      try {
        const response = await fetch('/api/profile');
        
        if (!response.ok) {
          container.innerHTML = '<div class="error-message">Morate biti prijavljeni da biste vidjeli korisnički profil!</div><p><a href="/login">Vratite se na prijavu</a></p>';
          return;
        }
        
        const user = await response.json();
        
        let profileHtml = '<h2>Korisnički profil</h2>';
        
        if (user.picture) {
          profileHtml += `<img src="${user.picture}" alt="Profilna slika" class="profile-picture">`;
        }
        
        profileHtml += `
          <div class="profile-item">
            <span class="profile-label">Ime:</span>
            <span class="profile-value">${user.name || 'Nije dostupno'}</span>
          </div>
          <div class="profile-item">
            <span class="profile-label">Email:</span>
            <span class="profile-value">${user.email || 'Nije dostupno'}</span>
          </div>
          <div class="profile-item">
            <span class="profile-label">Nadimak:</span>
            <span class="profile-value">${user.nickname || 'Nije dostupno'}</span>
          </div>
          <div class="profile-item">
            <span class="profile-label">ID korisnika:</span>
            <span class="profile-value">${user.sub || 'Nije dostupno'}</span>
          </div>
          <div class="profile-item">
            <span class="profile-label">Zadnja ažuriranja:</span>
            <span class="profile-value">${user.updated_at ? new Date(user.updated_at).toLocaleString('hr-HR') : 'Nije dostupno'}</span>
          </div>
        `;
        
        container.innerHTML = profileHtml;
      } catch (error) {
        console.error('Error loading profile:', error);
        container.innerHTML = '<div class="error-message">Greška pri učitavanju profila!</div><p><a href="/">Vratite se na početnu stranicu</a></p>';
      }
    }
    
    // Učitaj profil pri učitavanju stranice
    document.addEventListener('DOMContentLoaded', loadProfile);
  </script>
</body>
</html>
